<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Uppy Diagnostic Upload</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- ‚úÖ CORB-safe Uppy v3.5.0 Bundle via jsDelivr -->
  <script src="https://cdn.jsdelivr.net/npm/@uppy/uppy@3.5.0/dist/uppy.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@uppy/uppy@3.5.0/dist/uppy.min.css" />

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 2em;
    }
    #drag-drop-area {
      margin-top: 2em;
    }
    #status {
      margin-top: 1em;
      color: #333;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h2>Uppy Diagnostic Upload</h2>
  <div id="drag-drop-area"></div>
  <div id="status">üîç Status: Waiting for Uppy to load...</div>

  <script>
    // Confirm Uppy is defined
    if (typeof Uppy === 'undefined') {
      document.getElementById('status').textContent = '‚ùå Uppy is not defined. Script may have failed to load.';
      console.error('Uppy is undefined. Check if the script was blocked or failed to load.');
    } else {
      document.getElementById('status').textContent = '‚úÖ Uppy loaded successfully. Initializing...';

      const uppy = new Uppy.Core({
        debug: true,
        autoProceed: false
      })

      uppy.use(Uppy.Dashboard, {
        inline: true,
        target: '#drag-drop-area',
        showProgressDetails: true
      })

      uppy.use(Uppy.XHRUpload, {
        endpoint: 'https://qfiknfbru7xmrtczcqy2767hju0innfi.lambda-url.us-west-2.on.aws/',
        fieldName: 'file',
        formData: true,
        bundle: true
      })

      uppy.on('complete', (result) => {
        console.log('‚úÖ Upload complete:', result.successful)
        document.getElementById('status').textContent = `${result.successful.length} file(s) uploaded successfully.`
      })

      uppy.on('error', (error) => {
        console.error('‚ùå Uppy error:', error)
        document.getElementById('status').textContent = '‚ùå Upload failed. Check console for details.'
      })
    }
  </script>
</body>
</html>
